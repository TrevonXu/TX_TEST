Final result of merging

Branch B1

B2 attempt 2
